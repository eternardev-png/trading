.chart-panel {
    position: relative;
    width: 100%;
    height: 100%;
    background: #131722;
    overflow: hidden; // Prevent accidental layout shifts/scrollbars

    &__header-wrapper {
        position: absolute;
        top: 4px;
        left: 4px;
        z-index: 10;
        display: flex;
        flex-direction: column;
        gap: 2px;
        pointer-events: none; // Click through transparent areas
    }

    &__ticker-row {
        position: relative;
        display: flex;
        align-items: center;
        gap: 4px;
        pointer-events: auto;

        // Container for Ticker Info + 3 Dots (The "Box")
        .ticker-info {
            display: flex;
            align-items: center;
            gap: 0;
            padding: 2px 4px;
            border-radius: 4px;
            transition: background 0.1s;
            cursor: default;

            // The Hover Box Effect
            &:hover {
                background: #1e222d; // Dark box color
                z-index: 20;
                box-shadow: 0 0 0 1px #2a2e39; // Slight border effect
            }

            // Symbol Search Button (Icon + Ticker)
            .symbol-search-btn {
                display: flex;
                align-items: center;
                gap: 6px;
                padding: 2px 4px;
                background: transparent;
                border: none;
                border-radius: 4px;
                cursor: pointer;
                color: #d1d4dc;
                transition: color 0.1s;

                &:hover {
                    color: #fff;
                    // Note: No background on button hover, the parent box has it
                }

                svg {
                    color: #b2b5be;
                    width: 18px;
                    height: 18px;
                }

                .ticker-text {
                    font-size: 14px;
                    font-weight: 600;
                    letter-spacing: 0.5px;
                }
            }

            .info-separator {
                width: 1px;
                height: 14px;
                background: #2a2e39;
                margin: 0 6px;
            }

            .timeframe {
                font-size: 13px;
                color: #d1d4dc;
                font-weight: 500;
                margin-right: 6px;
                cursor: pointer;
                padding: 2px 4px;
                border-radius: 4px;

                &:hover {
                    background: rgba(255, 255, 255, 0.06);
                }
            }

            .exchange {
                font-size: 10px;
                font-weight: 600;
                color: #787b86;
                padding: 1px 4px;
                text-transform: uppercase;
                letter-spacing: 0.3px;
                margin-right: 2px;
            }

            // Series Menu in Ticker Row
            .series-menu {
                margin-left: 2px;

                // Hidden by default (hover-only)
                &--hover-only .series-menu__trigger {
                    opacity: 0;
                    width: 0; // Collapse width when hidden? No, just fade
                    overflow: hidden;
                }

                &__trigger {
                    width: 18px; // Smaller dots for main ticker
                    height: 18px;
                    font-size: 16px;
                }
            }

            // Reveal 3 dots when hovering usage the PARENT .ticker-info
            &:hover .series-menu--hover-only .series-menu__trigger {
                opacity: 1;
                width: 18px; // Ensure width is back
            }
        }

        .ohlc-group {
            display: flex;
            align-items: center;
            gap: 8px;
            /* Slightly wider gap between items for clarity */
            margin-left: 12px;
            pointer-events: none;

            // On mobile or small screens, might want to hide
            @media (max-width: 600px) {
                display: none;
            }

            .ohlc-item {
                display: flex;
                align-items: baseline; // Align text bottom
                gap: 4px;

                .label {
                    font-size: 12px;
                    color: #787b86;
                    font-weight: 500;
                }

                .value {
                    font-size: 12px;
                    color: #d1d4dc;
                    // Improved readability font
                    font-family: 'Roboto Mono', 'Consolas', 'Menlo', monospace;
                    font-weight: 400;
                }
            }

            .change {
                font-size: 12px;
                font-weight: 400;
                margin-left: 4px;
                font-family: 'Roboto Mono', 'Consolas', 'Menlo', monospace;
            }
        }
    }



    &__indicators-row {
        position: relative; // Not absolute
        // top/left removed
        display: flex;
        align-items: center;
        gap: 8px;
        pointer-events: auto;

        .indicator {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 3px 8px;
            margin-left: -8px;
            border-radius: 3px;
            border: 1px solid transparent;
            transition: all 0.1s ease;
            min-height: 24px;

            &:hover {
                background: #1e222d;
                border-color: #363a45;
            }

            // При наведении показываем кнопки действий
            &:hover .action-buttons {
                opacity: 1;
            }

            // Скрытый индикатор - тусклый текст
            &--hidden {

                .ind-name,
                .ind-value {
                    opacity: 0.4;
                }
            }
        }

        // Кнопка глаза - всегда видна
        .eye-btn {
            width: 20px;
            height: 20px;
            font-size: 12px;
            line-height: 1;
            color: #787b86;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 3px;
            transition: all 0.1s ease;
            flex-shrink: 0;

            &:hover {
                background: #363a45;
                color: #d1d4dc;
            }

            // Глаз выключен - зачёркнутый стиль
            &--off {
                color: #4a4e59;
            }
        }

        .action-buttons {
            display: flex;
            align-items: center;
            gap: 4px;
            opacity: 0;
            transition: opacity 0.1s ease;
        }

        .action-btn {
            width: 22px;
            height: 22px;
            font-size: 13px;
            color: #787b86;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 3px;
            transition: all 0.1s ease;

            &:hover {
                background: #363a45;
                color: #d1d4dc;
            }

            &--danger:hover {
                background: #ef5350;
                color: #fff;
            }
        }

        .ind-name {
            font-size: 12px;
            color: #26a69a;
            font-weight: 500;
            pointer-events: none;
            transition: opacity 0.1s ease;
        }

        .ind-value {
            font-size: 12px;
            color: #b2b5be;
            font-family: 'Trebuchet MS', -apple-system, BlinkMacSystemFont, sans-serif;
            pointer-events: none;
            transition: opacity 0.1s ease;
        }
    }

    &__chart {
        width: 100%;
        height: 100%;
    }

    &__layers-btn {
        position: absolute;
        top: 4px;
        right: 6px;
        z-index: 10;
        width: 24px;
        height: 24px;
        font-size: 12px;
        color: #787b86;
        border-radius: 3px;
        transition: all 0.1s ease;

        &:hover {
            background: #1e222d;
            color: #d1d4dc;
        }
    }

    .chart-separator {
        height: 6px;
        background: #2a2e39; // Visible separator color
        cursor: row-resize;
        z-index: 20;
        transition: background 0.2s;
        margin-top: -3px;
        margin-bottom: -3px;
        position: relative;
        flex-shrink: 0;

        &:hover,
        &:active {
            background: #2962ff;
        }

        &::after {
            // Invisible hit area extension
            content: '';
            position: absolute;
            top: -3px;
            bottom: -3px;
            left: 0;
            right: 0;
        }
    }

    .chart-logo {
        position: absolute;
        bottom: 42px;
        left: 12px;
        width: 28px;
        height: 28px;
        z-index: 50;
        pointer-events: none;
        opacity: 1;
        object-fit: contain;
        filter: drop-shadow(0 0 10px rgba(239, 83, 80, 0.6)); // Stronger Red glow
    }

    // Hide TradingView Logo (Force override)
    a[href*="tradingview.com"],
    .tv-lightweight-charts-attribution {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
        pointer-events: none !important;
    }

    // Scale Controls (Auto / Log)
    // Scale Controls (Auto / Log)
    .scale-controls {
        position: absolute;
        bottom: 30px; // Above TimeScale (~26px height)
        z-index: 100; // High z-index
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 4px;
        padding: 4px 6px; // Added horizontal padding
        background: #1e222d; // Dark box background
        border: 1px solid #2a2e39; // Subtle border
        border-radius: 4px; // Rounded corners
        opacity: 1; // Always visible
        pointer-events: auto;
        width: auto; // Content width
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3); // Shadow for depth

        &--left {
            left: 6px;
        }

        &--right {
            right: 6px; // Bottom Right Corner
        }
    }

    // Show on hover of the control itself OR the parent pane scale area?
    // Since we can't target "scale area" easily with CSS only from here without structure changes,
    // We will show it when hovering the chart pane near the edge? 
    // Simplest: Show when hovering the .chart-pane (ChartPane.scss dependency needed? No, chart-pane class is on div)
    // We need to target .scale-controls inside .chart-pane:hover
    // But the user said "when I hover the scale".
    // Let's rely on .chart-pane:hover for now as it covers "hovering the scale".


    // We need to nest this logic or use parent selector if supported, or move out.
    // SCSS supports nesting.

    // BUT, .scale-controls is inside ChartPanel.scss which might not duplicate .chart-pane structure.
    // .chart-panel .chart-pane .scale-controls?
    // Let's assume ChartPane.jsx adds 'scale-controls' inside 'chart-pane'.

    // To make it work:
    // We'll update the rule above to Include the hover trigger.


    .scale-btn {
        background: rgba(255, 255, 255, 0.02); // Subtle background for visibility
        border: none;
        color: #787b86;
        font-size: 13px; // Increased from 10px
        font-weight: bold;
        cursor: pointer;
        padding: 4px 8px; // Increased padding
        border-radius: 4px;
        transition: all 0.2s;
        min-width: 24px; // Ensure touch target size
        display: flex;
        align-items: center;
        justify-content: center;

        &:hover {
            color: #d1d4dc;
            background: rgba(255, 255, 255, 0.1);
        }

        &.active {
            color: #2962ff;
            background: rgba(41, 98, 255, 0.15);
        }
    }

    // Chart Controls - Top Right
    .chart-controls {
        position: absolute;
        top: 8px;
        right: 8px;
        z-index: 100;
        display: flex;
        gap: 4px;
        background: rgba(19, 23, 34, 0.8);
        backdrop-filter: blur(4px);
        padding: 4px;
        border-radius: 6px;
        border: 1px solid #2a2e39;
    }

    .chart-control-btn {
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: transparent;
        border: none;
        border-radius: 4px;
        color: #787b86;
        cursor: pointer;
        transition: all 0.2s;
        font-size: 16px;

        &:hover {
            background: #2a2e39;
            color: #d1d4dc;
        }

        &.active {
            background: #2962ff;
            color: white;

            &:hover {
                background: #1e53e5;
            }
        }

        &.inactive {
            opacity: 0.4;
        }

        svg {
            width: 20px;
            height: 20px;
        }
    }
}