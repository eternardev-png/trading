.chart-panel {
    position: relative;
    width: 100%;
    height: 100%;
    // Ensure the chart background is overridden by component state or handled here if needed.
    // For transparent look, we might rely on the container background.
    background: transparent;
    overflow: hidden;
    padding: 12px; // Space for the floating card effect

    // Individual Pane Styling override (if we want gaps)
    // Actually, ChartPanel contains multiple panes.
    display: flex;
    flex-direction: column;
    gap: 8px;

    &__chart {
        border-radius: var(--border-radius-md);
        overflow: hidden; // Important for rounding
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2); // Settle shadow
    }

    &__header-wrapper {
        position: absolute;
        top: 8px;
        left: 8px;
        z-index: 10;
        display: flex;
        flex-direction: column;
        gap: 4px;
        pointer-events: none;
    }

    &__ticker-row {
        position: relative;
        display: flex;
        align-items: center;
        gap: 6px;
        pointer-events: auto;

        .ticker-info {
            display: flex;
            align-items: center;
            gap: 2px;
            padding: 4px 8px;
            border-radius: 6px;
            /* Slightly softer radius */
            background: rgba(30, 34, 45, 0.3);
            /* Glassy dark */
            backdrop-filter: blur(6px);
            /* Glass effect */
            border: 1px solid rgba(255, 255, 255, 0.05);
            /* Subtle rim */
            transition: all 0.2s ease;
            cursor: default;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            /* Soft shadow */

            &:hover {
                background: rgba(30, 34, 45, 0.6);
                border-color: rgba(255, 255, 255, 0.1);
                box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
                transform: translateY(-1px);
                z-index: 20;
            }

            .symbol-search-btn {
                display: flex;
                align-items: center;
                gap: 8px;
                padding: 2px 4px;
                background: transparent;
                border: none;
                cursor: pointer;
                color: var(--text-primary);

                &:hover {
                    text-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
                }

                svg {
                    width: 16px;
                    height: 16px;
                    color: var(--accent-blue);
                }

                .ticker-text {
                    font-size: 15px;
                    font-weight: 700;
                    letter-spacing: -0.02em;
                }
            }

            .info-separator {
                width: 1px;
                height: 14px;
                background: rgba(255, 255, 255, 0.1);
                margin: 0 6px;
            }

            .timeframe {
                font-size: 13px;
                color: #d1d4dc;
                font-weight: 500;
                margin-right: 6px;
                cursor: pointer;
                padding: 2px 4px;
                border-radius: 4px;

                &:hover {
                    background: rgba(255, 255, 255, 0.08);
                }
            }

            .exchange {
                font-size: 10px;
                font-weight: 600;
                color: #787b86;
                padding: 1px 4px;
                text-transform: uppercase;
                letter-spacing: 0.3px;
                margin-right: 2px;
            }

            // Series Menu in Ticker Row
            .series-menu {
                margin-left: 2px;

                // Hidden by default (hover-only)
                &--hover-only .series-menu__trigger {
                    opacity: 0;
                    width: 0;
                    overflow: hidden;
                }

                &__trigger {
                    width: 18px;
                    height: 18px;
                    font-size: 16px;
                }
            }

            // Reveal 3 dots when hovering usage the PARENT .ticker-info
            &:hover .series-menu--hover-only .series-menu__trigger {
                opacity: 1;
                width: 18px;
            }
        }

        .ohlc-group {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: 12px;
            pointer-events: none;

            @media (max-width: 600px) {
                display: none;
            }

            .ohlc-item {
                display: flex;
                align-items: baseline;
                gap: 4px;

                .label {
                    font-size: 12px;
                    color: #787b86;
                    font-weight: 500;
                }

                .value {
                    font-size: 12px;
                    color: #d1d4dc;
                    font-family: 'Roboto Mono', 'Consolas', 'Menlo', monospace;
                    font-weight: 400;
                }
            }

            .change {
                font-size: 12px;
                font-weight: 400;
                margin-left: 4px;
                font-family: 'Roboto Mono', 'Consolas', 'Menlo', monospace;
            }
        }
    }



    &__indicators-row {
        position: relative;
        display: flex;
        align-items: center;
        gap: 8px;
        pointer-events: auto;

        .indicator {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 3px 8px;
            margin-left: 0;
            /* Keep reset */
            border-radius: 4px;
            background: transparent;
            /* Transparent default */
            border: 1px solid transparent;
            /* No border default */
            transition: all 0.2s ease;
            min-height: 24px;

            /* Glass on hover/active or slightly visible? 
               Screenshot shows bare text for indicator? 
               Let's make it very subtle glass. */

            &:hover {
                background: rgba(30, 34, 45, 0.4);
                backdrop-filter: blur(4px);
                border-color: rgba(255, 255, 255, 0.05);
                z-index: 10;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            }

            // При наведении показываем кнопки действий
            &:hover .action-buttons {
                opacity: 1;
            }

            // Скрытый индикатор - тусклый текст
            &--hidden {
                opacity: 0.6;
                // No background for hidden

                .ind-name,
                .ind-value {
                    opacity: 0.5;
                }
            }
        }

        // Кнопка глаза - всегда видна
        .eye-btn {
            width: 20px;
            height: 20px;
            font-size: 12px;
            line-height: 1;
            color: #787b86;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 3px;
            transition: all 0.1s ease;
            flex-shrink: 0;

            &:hover {
                background: rgba(255, 255, 255, 0.1);
                color: #d1d4dc;
            }

            // Глаз выключен - зачёркнутый стиль
            &--off {
                color: #4a4e59;
            }
        }

        .action-buttons {
            display: flex;
            align-items: center;
            gap: 4px;
            opacity: 0;
            transition: opacity 0.1s ease;
        }

        .action-btn {
            width: 22px;
            height: 22px;
            font-size: 13px;
            color: #787b86;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 3px;
            transition: all 0.1s ease;

            &:hover {
                background: rgba(255, 255, 255, 0.1);
                color: #d1d4dc;
            }

            &--danger:hover {
                background: #ef5350;
                color: #fff;
            }
        }

        .ind-name {
            font-size: 12px;
            color: #26a69a;
            font-weight: 500;
            pointer-events: none;
            transition: opacity 0.1s ease;
        }

        .ind-value {
            font-size: 12px;
            color: #b2b5be;
            font-family: 'Trebuchet MS', -apple-system, BlinkMacSystemFont, sans-serif;
            pointer-events: none;
            transition: opacity 0.1s ease;
        }
    }

    &__chart {
        width: 100%;
        height: 100%;
    }

    &__layers-btn {
        position: absolute;
        top: 4px;
        right: 6px;
        z-index: 10;
        width: 24px;
        height: 24px;
        font-size: 12px;
        color: #787b86;
        border-radius: 3px;
        transition: all 0.1s ease;

        &:hover {
            background: #1e222d;
            color: #d1d4dc;
        }
    }

    .chart-separator {
        height: 6px;
        background: #2a2e39; // Visible separator color
        cursor: row-resize;
        z-index: 20;
        transition: background 0.2s;
        margin-top: -3px;
        margin-bottom: -3px;
        position: relative;
        flex-shrink: 0;

        &:hover,
        &:active {
            background: #2962ff;
        }

        &::after {
            // Invisible hit area extension
            content: '';
            position: absolute;
            top: -3px;
            bottom: -3px;
            left: 0;
            right: 0;
        }
    }

    .chart-logo {
        position: absolute;
        bottom: 42px;
        left: 12px;
        width: 28px;
        height: 28px;
        z-index: 50;
        pointer-events: none;
        opacity: 1;
        object-fit: contain;
        filter: drop-shadow(0 0 10px rgba(239, 83, 80, 0.6)); // Stronger Red glow
    }

    // Hide TradingView Logo (Force override)
    a[href*="tradingview.com"],
    .tv-lightweight-charts-attribution {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
        pointer-events: none !important;
    }

    // Scale Controls (Auto / Log)
    // Scale Controls (Auto / Log)
    // Scale Controls (Auto / Log)
    .scale-controls {
        position: absolute;
        bottom: 30px; // Above TimeScale (~26px height)
        z-index: 100; // High z-index
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 4px;
        padding: 4px 6px; // Added horizontal padding
        background: rgba(var(--bg-secondary-rgb), 0.95); // Dynamic Dark
        border: 1px solid var(--glass-border); // Subtle border
        border-radius: 4px; // Rounded corners
        opacity: 1; // Always visible
        pointer-events: auto;
        width: auto; // Content width
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3); // Shadow for depth

        &--left {
            left: 6px;
        }

        &--right {
            right: 6px; // Bottom Right Corner
        }
    }

    // Show on hover of the control itself OR the parent pane scale area?
    // Since we can't target "scale area" easily with CSS only from here without structure changes,
    // We will show it when hovering the .chart-pane near the edge? 
    // Simplest: Show when hovering the .chart-pane (ChartPane.scss dependency needed? No, chart-pane class is on div)
    // We need to target .scale-controls inside .chart-pane:hover
    // But the user said "when I hover the scale".
    // Let's rely on .chart-pane:hover for now as it covers "hovering the scale".


    // We need to nest this logic or use parent selector if supported, or move out.
    // SCSS supports nesting.

    // BUT, .scale-controls is inside ChartPanel.scss which might not duplicate .chart-pane structure.
    // .chart-panel .chart-pane .scale-controls?
    // Let's assume ChartPane.jsx adds 'scale-controls' inside 'chart-pane'.

    // To make it work:
    // We'll update the rule above to Include the hover trigger.


    .scale-btn {
        background: rgba(255, 255, 255, 0.02); // Subtle background for visibility
        border: none;
        color: var(--text-secondary);
        font-size: 13px; // Increased from 10px
        font-weight: bold;
        cursor: pointer;
        padding: 4px 8px; // Increased padding
        border-radius: 4px;
        transition: all 0.2s;
        min-width: 24px; // Ensure touch target size
        display: flex;
        align-items: center;
        justify-content: center;

        &:hover {
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.1);
        }

        &.active {
            color: var(--accent-blue);
            background: var(--accent-blue-glow); // Dynamic glow
        }
    }

    // Chart Controls - Top Right
    .chart-controls {
        position: absolute;
        top: 8px;
        right: 8px;
        z-index: 100;
        display: flex;
        gap: 4px;
        background: rgba(19, 23, 34, 0.8);
        backdrop-filter: blur(4px);
        padding: 4px;
        border-radius: 6px;
        border: 1px solid #2a2e39;
    }

    .chart-control-btn {
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: transparent;
        border: none;
        border-radius: 4px;
        color: #787b86;
        cursor: pointer;
        transition: all 0.2s;
        font-size: 16px;

        &:hover {
            background: #2a2e39;
            color: #d1d4dc;
        }

        &.active {
            background: var(--accent-blue);
            color: white;

            &:hover {
                filter: brightness(1.1); // Dynamic hover
            }
        }

        &.inactive {
            opacity: 0.4;
        }

        svg {
            width: 20px;
            height: 20px;
        }
    }

    // New Floating Settings Button (Top-Right over Scale)
    .chart-floating-settings-btn {
        position: absolute;
        top: 60px; // Lower it down so it doesn't overlap with header/timeframe
        right: 10px; // Floating near the scale
        z-index: 50;
        width: 34px;
        height: 34px;
        background: rgba(30, 34, 45, 0.6); // Semi-transparent dark
        border: 1px solid #2a2e39;
        border-radius: 6px;
        color: #787b86;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        transition: all 0.2s;
        backdrop-filter: blur(2px);

        &:hover {
            background: #2a2e39;
            color: #d1d4dc;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }
    }
}